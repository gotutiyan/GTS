# Taking the Correction Difficulty into Account in Grammatical Error Correction Evaluation

Code for the paper: "Taking the Correction Difficulty into Account in Grammatical Error Correction Evaluation". (In COLING 2020) 

### Usage

```bash
python3 gotoscorer.py -ref <ref_m2_path> -hyp <hyp_m2> -sys_name <sys_1,sys_2,...,sys_N> 
```

`-ref <ref_m2_path> ` represents a correction of correct answer and `-hyp <hyp_m2_path> ` represents corrections of system．The format of each file is M2, which is generated by [ERRANT](https://github.com/chrisjbryant/errant). You can see `demo/ref.m2` and `demo/hyp.m2` for an example.

`-sys_name <sys_1,sys_2,...,sys_N>` is option to register system names. Each name should separated by comma.

each oprions is required.

### Other options

* `-heat <out_file_path>`

  Generate a visualizer of error correction difficulty. The visualizer corresponds to Figure 1 in the paper, like heat-map. You can see `demo/heat_map.html` for an example.

* `-cat <out_file_path>`

  Compute mean and standard deviation of each error type difficulty in descending order. It corresponds to Table 4 in the paper. You can see `demo/error_type_difficulty.txt` for an example.

* `-gen_w_file <weight_file_path>`

  Generate weight-file. The format is total number of systems in the first row, and number of correct systems for each chunk in the second and subsequent line. You can see `demo/weight.txt` for an example.

* `-w_file <weight_file_path>`

  Evaluate systems for using weight-file.  This function is for evaluating system in isolation.

### Demo

`python3 gotoscorer.py -ref demo/ref.m2 -hyp demo/hyp.m2 -sys_name sys1,sys2,sys3` 

Output：

![output_format](./image/output_format.png)

[demo](https://github.com/gotutiyan/GTS/tree/master/demo) describes the detail.

### Generating and format of input files

Using GTS requires 2 files, each format is M2 generated by [ERRANT](https://github.com/chrisjbryant/errant). 

**Example for using demo data**

* generating `demo/hyp.m2`

 `errant_parallel -orig demo/orig.txt -cor demo/sys1.txt demo/sys2.txt demo/sys3.txt -out demo/hyp.m2`

* generating `demo/ref.m2`

`errant_parallel -orig demo/orig.txt -cor demo/gold.txt -out demo/ref.m2`

### Visualizer of error correction difficulty

GTS provides a visualizer of error correction difficulty.
Errors are colored according to the success rate: pale (easiest) to deep (hardest).  Furthermore, the red color indicates a correct correction and blue color indicates an incorrect correction. If you mouseover colored words, you can see the detail of the correction: error type, correct correction, difficulty.

![heat_map](./image/heat_map.gif)